:root{
  --bg:#f6f8fc;--bg2:#eef2f9;--panel:#ffffff;--panel2:#fafbff;--accent:#7c5676;--muted:#5a5f73;--chip:#fff;--chip-br:#dfe3ee;--sidebar-w:320px;
  --header-h:56px;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;height:100%;width:100%;font-family:'Poppins',sans-serif}

body{
  display:grid;
  grid-template-columns:var(--sidebar-w) 1fr;
  grid-template-rows:var(--header-h) 1fr;
  grid-template-areas:"header header" "sidebar map";
  height:100vh;
  overflow:hidden; /* sin scroll global */
  background:linear-gradient(180deg,var(--bg),var(--bg2));
  color:#2a3140;
  transition:grid-template-columns .25s ease;
}
body.collapsed{--sidebar-w:0px}

header{
  grid-area:header;display:flex;align-items:center;gap:.75rem;padding:.8rem 1rem;
  background:rgba(255,255,255,.9);backdrop-filter:saturate(130%) blur(6px);
  border-bottom:1px solid #dfe3ee;position:sticky;top:0;z-index:10;height:var(--header-h)
}
header h1{font-size:1.1rem;margin:0}
.btn{display:inline-flex;align-items:center;gap:.4rem;font-size:.82rem;padding:.5rem .8rem;border-radius:12px;border:1px solid #dfe3ee;background:linear-gradient(180deg,#fff,#f7f9ff);cursor:pointer}

#sidebar{
  grid-area:sidebar;background:linear-gradient(180deg,var(--panel),var(--panel2));
  border-right:1px solid #dfe3ee;display:flex;flex-direction:column;min-width:260px;
  box-shadow:inset 0 1px 0 rgba(0,0,0,.02);transform:translateX(0);transition:transform .25s ease;
  overflow:hidden; /* scroll solo en #list */
}
body.collapsed #sidebar{transform:translateX(-100%)}

.controls{padding:14px 12px 12px;border-bottom:1px solid #e6eaf4;flex-shrink:0}
.controls label{display:block;font-size:.8rem;color:#5a5f73;margin:.35rem 0 .15rem}
.controls input[type="text"], .controls input[type="date"]{
  width:100%;background:var(--chip);border:1px solid var(--chip-br);border-radius:12px;color:#2a3140;padding:.65rem .8rem;outline:none;transition:.2s border-color
}
.controls input[type="text"]:focus, .controls input[type="date"]:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(107,107,248,.15)}
.chips{display:flex;flex-wrap:wrap;gap:.4rem;margin-top:.6rem}
.chip{font-size:.78rem;padding:.35rem .7rem;border-radius:999px;border:1px solid var(--chip-br);background:var(--chip);cursor:pointer;user-select:none}
.chip.active{border-color:var(--accent);color:#fff;background:var(--accent)}
.row-2{display:grid;grid-template-columns:1fr 1fr;gap:.5rem}
.toolbar{display:flex;gap:.5rem;align-items:center;margin-top:.6rem}

/* Lista con scroll y barra delgada + hover */
#list{flex:1;overflow:auto;min-height:0;padding:10px}
#list::-webkit-scrollbar{width:5px}
#list::-webkit-scrollbar-track{background:transparent}
#list::-webkit-scrollbar-thumb{background:#c0c0c0;border-radius:50px;transition:background-color .3s}
#list::-webkit-scrollbar-thumb:hover{background:#a0a0a0}
#list{scrollbar-width:thin;scrollbar-color:#c0c0c0 transparent}
#list:hover{scrollbar-color:#a0a0a0 transparent}

/* Tarjetas */
.card{
  background:#fff;
  border:2px solid #d0d0e0;
  border-radius:18px;
  padding:14px;
  margin:14px 0;
  display:grid;
  grid-template-columns:56px 1fr;
  gap:14px;
  align-items:center;
  box-shadow:0 6px 24px rgba(107,107,248,.10), 0 1.5px 8px rgba(0,0,0,.08);
  transition:box-shadow .2s, border-color .2s;
}
.card:hover{
  box-shadow:0 12px 32px rgba(107,107,248,.18), 0 2px 12px rgba(0,0,0,.12);
  border-color:var(--accent);
}

.thumb{width:56px;height:56px;border-radius:12px;object-fit:cover;border:1px solid #e2e6f0;background:#f4f6fb}
.meta{font-size:.78rem;color:#6d738a}
.title{font-weight:600}

/* Mapa */
#map{grid-area:map;position:relative;min-height:0}
#map,.leaflet-container{height:100%;width:100%}
.leaflet-container{background:#e9eef7}

/* Leyenda y popup */
.legend{position:absolute;right:12px;bottom:12px;background:#fff;border:1px solid #dfe3ee;border-radius:12px;padding:10px 12px;font-size:.82rem;box-shadow:0 4px 12px rgba(0,0,0,.06)}
.leaflet-popup-content-wrapper {
  max-width: 360px;
  width: 100%;
  box-sizing: border-box;
}



.leaflet-popup-tip{background:#fff;border:1px solid #e6eaf4}

.leaflet-popup-close-button {
  position: absolute !important;
  right: 8px !important;
  top: 8px !important;
  width: 28px;
  height: 28px;
  border-radius: 999px;
  background: rgba(255,255,255,0.92);
  border: 1px solid #dfe3ee;
  color: #6b6bf8;
  font-size: 1.3rem;
  line-height: 28px;
  text-align: center;
  box-shadow: 0 2px 8px rgba(0,0,0,.08);
  z-index: 20;
  cursor: pointer;
  transition: background .18s, color .18s, box-shadow .18s;
}
.leaflet-popup-close-button:hover {
  background: #6b6bf8;
  color: #fff;
  box-shadow: 0 4px 16px rgba(107,107,248,.18);
}

/* Marcadores */

/* Animación de pulso para corazones */
.heart-marker {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
.heart-marker svg {
  transition: transform .22s cubic-bezier(.4,1.4,.4,1), filter .22s;
}
.heart-marker:hover svg {
  transform: scale(1.18);
  filter: drop-shadow(0 0 16px #ffb3c6) drop-shadow(0 4px 16px #888);
}
.marker-dot{width:18px;height:18px;border-radius:999px;border:2px solid #fff;box-shadow:0 0 0 6px rgba(0,0,0,.08)}
.marker-dot.pulse::after{content:"";position:absolute;inset:-7px;border-radius:999px;border:2px solid currentColor;opacity:.35;animation:pulse 1.4s ease-out infinite}
@keyframes pulse{0%{transform:scale(.6);opacity:.6}100%{transform:scale(1.6);opacity:0}}

/* ===== Galería (carrusel dentro del popup) ===== */

.gallery {
  width: 100%;
  max-width: 320px;
  aspect-ratio: 4/3;
  margin: .45rem 0 .6rem;
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid #e6eaf4;
  background: #fff;
  display: block;
  box-sizing: border-box;
}

.gallery .slide {
  width: 100%;
  height: 0;
  padding-bottom: 75%; /* 4:3 aspect ratio */
  position: relative;
  display: block;
  background: #f7f7fa;
}

.gallery .track{  display: flex;
  height: 100%;
  transition: transform .35s ease;
  touch-action: pan-y;}

.gallery .slide img,
.gallery .slide video {
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  object-fit: contain !important;
  max-width: 100%;
  max-height: 100%;
  display: block;
  background: #f7f7fa;
  border-radius: 0;
  box-sizing: border-box;
}

/* Botones y dots */
.gbtn{
  position:absolute;top:50%;transform:translateY(-50%);
  border:1px solid #dfe3ee;background:rgba(255,255,255,.9);
  width:30px;height:30px;border-radius:999px;cursor:pointer;display:grid;place-items:center;font-size:18px;line-height:1;
  box-shadow:0 2px 8px rgba(0,0,0,.08)
}
.gbtn.prev{left:6px}.gbtn.next{right:6px}
.dots{position:absolute;left:0;right:0;bottom:6px;display:flex;gap:6px;justify-content:center;align-items:center}
.dot{width:8px;height:8px;border-radius:999px;background:#cfd5e6;cursor:pointer}
.dot.active{background:var(--accent)}

/* Pantalla completa
:fullscreen .fs-media{width:100vw;height:100vh;background:#000;display:grid;place-items:center}
:fullscreen .fs-media img, :fullscreen .fs-media video{max-width:100%;max-height:100%;object-fit:contain}
 */
/* Botón fullscreen */
/*.fs-btn{
  position:absolute;right:6px;top:6px;width:28px;height:28px;border-radius:999px;
  border:1px solid #dfe3ee;background:rgba(255,255,255,.9);display:grid;place-items:center;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.08)
}*/

/* Mobile */
@media (max-width:900px){
  body{grid-template-columns:1fr;grid-template-rows:var(--header-h) 1fr;grid-template-areas:"header" "map"}
  #sidebar{position:fixed;inset:var(--header-h) 0 auto 0;max-width:420px;width:min(90vw,360px);border-right:0;border:1px solid #e6eaf4;box-shadow:0 12px 30px rgba(0,0,0,.1);transform:translateX(-100%)}
  body.menu-open #sidebar{transform:translateX(0)}
}

@media (max-width: 500px) {
  .leaflet-popup-content-wrapper {
    max-width: 98vw;
  }
  .gallery {
    max-width: 98vw;
  }
}